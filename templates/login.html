<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Teleprompter</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
        }
        
        .login-container {
            background: rgba(255, 255, 255, 0.95);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        
        .logo {
            font-size: 4rem;
            margin-bottom: 20px;
        }
        
        .login-container h1 {
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 2rem;
        }
        
        .login-container p {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }
        
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2d3748;
        }
        
        .form-group input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
            background: #f8f9ff;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        .btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .alert {
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: 500;
            text-align: left;
        }
        
        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .alert-info {
            background: #cce7ff;
            color: #004085;
            border: 1px solid #b3d7ff;
        }
        
        .security-note {
            background: #f0f9ff;
            border: 1px solid #bae6fd;
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            text-align: left;
            font-size: 0.9rem;
            color: #0c4a6e;
        }
        
        .security-note h4 {
            margin-bottom: 8px;
            color: #075985;
        }
        
        @media (max-width: 480px) {
            .login-container {
                margin: 20px;
                padding: 30px 20px;
            }
            
            .logo {
                font-size: 3rem;
            }
            
            .login-container h1 {
                font-size: 1.5rem;
            }
        }
        
        .loading {
            display: none;
            color: #666;
            font-size: 0.9rem;
            margin-top: 10px;
        }
        
        .loading.show {
            display: block;
        }
    </style>
</head>
<body>
    <div class="login-container">
        <div class="logo">üîê</div>
        <h1>Teleprompter Login</h1>
        <p>Please enter your system credentials</p>
        
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        <form method="POST" id="loginForm">
            <div class="form-group">
                <label for="username">üë§ Username</label>
                <input type="text" id="username" name="username" required autofocus>
            </div>
            
            <div class="form-group">
                <label for="password">üîë Password</label>
                <input type="password" id="password" name="password" required>
            </div>
            
            <button type="submit" class="btn" id="loginBtn">
                <span id="loginText">üöÄ Login</span>
                <span id="loadingText" style="display: none;">‚è≥ Authenticating...</span>
            </button>
            
            <div class="loading" id="loadingMessage">
                Verifying credentials with system authentication...
            </div>
        </form>
        
        <div class="security-note">
            <h4>üõ°Ô∏è Security Information</h4>
            {% if session.get('pam_available', True) %}
                <p>This application uses your system's PAM (Pluggable Authentication Modules) for secure login. Your credentials are verified against the same system used for your computer login and are never stored by this application.</p>
            {% else %}
                <p><strong>Development Mode:</strong> Authentication is disabled for development purposes. Use any username and password to access the interface.</p>
            {% endif %}
        </div>
    </div>
    
    <script>
        const form = document.getElementById('loginForm');
        const loginBtn = document.getElementById('loginBtn');
        const loginText = document.getElementById('loginText');
        const loadingText = document.getElementById('loadingText');
        const loadingMessage = document.getElementById('loadingMessage');
        
        form.addEventListener('submit', function(e) {
            // Show loading state
            loginText.style.display = 'none';
            loadingText.style.display = 'inline';
            loadingMessage.classList.add('show');
            loginBtn.disabled = true;
            
            // Form will submit normally, but we show loading state
            setTimeout(() => {
                if (loginBtn.disabled) {
                    // If still disabled after 10 seconds, re-enable (in case of error)
                    loginText.style.display = 'inline';
                    loadingText.style.display = 'none';
                    loadingMessage.classList.remove('show');
                    loginBtn.disabled = false;
                }
            }, 10000);
        });
        
        // Prevent double submission
        let submitted = false;
        form.addEventListener('submit', function(e) {
            if (submitted) {
                e.preventDefault();
                return false;
            }
            submitted = true;
        });
        
        // Focus on username field
        document.getElementById('username').focus();
        
        // Enter key handling
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Enter' && document.activeElement.tagName !== 'BUTTON') {
                const username = document.getElementById('username');
                const password = document.getElementById('password');
                
                if (document.activeElement === username && username.value) {
                    password.focus();
                } else if (document.activeElement === password && password.value) {
                    form.submit();
                }
            }
        });
    </script>
</body>
</html>
